% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames*,x11names*}{xcolor}
%
\documentclass[
  12pt]{findlay}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  colorlinks=true,
  linkcolor=black,
  filecolor=Maroon,
  citecolor=Green,
  urlcolor=blue,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{listings}
\newcommand{\passthrough}[1]{#1}
\lstset{defaultdialect=[5.3]Lua}
\lstset{defaultdialect=[x86masm]Assembler}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage[T1]{fontenc}
\usepackage{cmap}
\input{glyphtounicode}
\pdfgentounicode=1
\usepackage{enumitem}
\usepackage[]{biblatex}

\title{COMP5900 OS Security}
\date{\today}

\begin{document}
\maketitle

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

\begin{itemize}
\tightlist
\item
  trusted computing base

  \begin{itemize}
  \tightlist
  \item
    applications that are essential to functioning of the OS
  \item
    e.g., passwd
  \item
    these would probably be okay to talk about for OS vuln. but
    kernelspace code is preferred
  \end{itemize}
\end{itemize}

\hypertarget{blooms-taxonomy}{%
\subsection{Bloom's Taxonomy}\label{blooms-taxonomy}}

\begin{itemize}
\tightlist
\item
  course targets top 3 sections (for evaluation)

  \begin{itemize}
  \tightlist
  \item
    create
  \item
    evaluate
  \item
    analyze
  \item
    (some understanding)
  \end{itemize}
\end{itemize}

\hypertarget{what-is-an-os}{%
\subsection{What is an OS?}\label{what-is-an-os}}

\begin{itemize}
\tightlist
\item
  kernel
\item
  essential applications (systemd, passwd, etc.)
\item
  what does it do?

  \begin{itemize}
  \tightlist
  \item
    scheduling
  \item
    network stack
  \item
    file systems
  \item
    block I/O on disk
  \item
    hardware interrupts (e.g.~I/O)
  \item
    at least basic access control (memory protection, etc.)
  \item
    often runs in supervisor mode (apparently not necessarily? But I
    don't agree with this\ldots)
  \end{itemize}
\end{itemize}

\hypertarget{what-is-the-most-secure-os}{%
\subsection{What is the Most Secure
OS?}\label{what-is-the-most-secure-os}}

\begin{itemize}
\tightlist
\item
  probably something task-specific
\end{itemize}

\hypertarget{group-activity-come-up-with-an-os-less-implementation-for-a-word-processor}{%
\subsection{Group Activity: Come up with an OS-less implementation for a
word
processor}\label{group-activity-come-up-with-an-os-less-implementation-for-a-word-processor}}

\begin{itemize}
\tightlist
\item
  interrupt handling for keyboard

  \begin{itemize}
  \tightlist
  \item
    need at least some basic scheduler that can pause and resume main
    execution
  \end{itemize}
\item
  interface with monitor for graphical display
\item
  block I/O driver for disk

  \begin{itemize}
  \tightlist
  \item
    filesystem to organize data
  \end{itemize}
\item
  hmm\ldots{} this is starting to feel like we just implemented our own
  task-specific OS

  \begin{itemize}
  \tightlist
  \item
    that's the main takeaway here!
  \end{itemize}
\end{itemize}

\hypertarget{secure-os}{%
\section{Secure OS}\label{secure-os}}

\hypertarget{van-oorschot-chapter-5.0---5.2}{%
\subsection{Van Oorschot Chapter 5.0 -
5.2}\label{van-oorschot-chapter-5.0---5.2}}

\hypertarget{intro}{%
\subsubsection{Intro}\label{intro}}

\begin{itemize}
\tightlist
\item
  early security had same challenges we face today

  \begin{itemize}
  \tightlist
  \item
    protecting programs from others
  \item
    restricting access to resources
  \item
    ``protection'' means mostly memory access control
  \end{itemize}
\item
  memory is important

  \begin{itemize}
  \tightlist
  \item
    holds data
  \item
    holds programs
  \item
    I/O devices through memory address and files
  \item
    files -\textgreater{} both main memory and secondary storage
  \end{itemize}
\item
  early protection

  \begin{itemize}
  \tightlist
  \item
    virtual addresses
  \item
    access control lists
  \item
    limited process address space
  \item
    these fundamentals are still used today
  \end{itemize}
\item
  Multics

  \begin{itemize}
  \tightlist
  \item
    security very influential in its early design
  \item
    original UNIX was heavily based on Multics
  \end{itemize}
\end{itemize}

\hypertarget{memory-protection-supervisor-mode-and-accountability}{%
\subsubsection{Memory protection, supervisor mode, and
accountability}\label{memory-protection-supervisor-mode-and-accountability}}

\begin{itemize}
\tightlist
\item
  batch processing

  \begin{itemize}
  \tightlist
  \item
    prepare jobs ahead of time and submit them together as a batch job
  \end{itemize}
\item
  time-sharing systems

  \begin{itemize}
  \tightlist
  \item
    allowed shared use of a single computer
  \item
    (preferable to batch jobs from a usability standpoint)
  \item
    same way single-user computers work today with one user running many
    programs
  \end{itemize}
\item
  resource conflicts

  \begin{itemize}
  \tightlist
  \item
    processes running simultaneously can try to access the same
    resources
  \item
    intentionally or otherwise
  \item
    if a program could access full memory of the machine, errors could
    corrupt OS data or code
  \end{itemize}
\item
  supervisor

  \begin{itemize}
  \tightlist
  \item
    runs with higher permissions in the protection CPU (ring 0, 1, 2)
  \item
    no other program can alter the privileged bit
  \item
    a special machine instruction immediately transfers control to the
    supervisor
  \end{itemize}
\item
  privileged bit

  \begin{itemize}
  \tightlist
  \item
    process is running in supervisor mode
  \end{itemize}
\item
  descriptor register

  \begin{itemize}
  \tightlist
  \item
    holds a memory descriptor that describes base and upper bound
  \item
    lowest addressable memory by a process and a number of words from
    that point that are addressable
  \end{itemize}
\item
  limitations of memory-range based protection

  \begin{itemize}
  \tightlist
  \item
    all-or-nothing mode of control
  \item
    either you have full access or no access
  \item
    allows full isolation, but not fine-grained sharing
  \end{itemize}
\item
  segment addressing with access permissions

  \begin{itemize}
  \tightlist
  \item
    segment = collection of words representing a logical unit of
    information
  \item
    descriptor segment per process maintained by OS

    \begin{itemize}
    \tightlist
    \item
      holds segment descriptors that define addressable memory and
      permissions
    \end{itemize}
  \item
    descriptor base register points to memory descriptor of active
    process
  \end{itemize}
\item
  permissions on virtual segments

  \begin{itemize}
  \tightlist
  \item
    R non-supervisor can read
  \item
    W can be written to
  \item
    X can be executed
  \item
    M run in supervisor mode (if X)
  \item
    F all access attempts trap to supervisor
  \item
    now the same physical segment can be given different access for
    different processes
  \end{itemize}
\item
  accountability, UIDs, and principals

  \begin{itemize}
  \tightlist
  \item
    UID (maps users to a unique identifier)
  \item
    ``principal'' -\textgreater{} abstracts the entity responsible for
    code execution from the actual user or program actions
  \item
    UID is the primary basis for granting permissions
  \end{itemize}
\item
  roles

  \begin{itemize}
  \tightlist
  \item
    assign distinct UIDs to distinct privileges
  \item
    should follow principle of least privilege
  \end{itemize}
\end{itemize}

\hypertarget{reference-monitor-access-matrix-security-kernel}{%
\subsubsection{Reference monitor, access matrix, security
kernel}\label{reference-monitor-access-matrix-security-kernel}}

\begin{itemize}
\tightlist
\item
  reference monitor

  \begin{itemize}
  \tightlist
  \item
    concept that ``all references by any program to any other program,
    data, or device are validated''
  \item
    conceptualized as one reference monitor, but in practice, would be a
    lot of reference monitors working together
  \end{itemize}
\item
  access matrix

  \begin{itemize}
  \tightlist
  \item
    2D matrix of subjects, objects
  \item
    taking a row (subject) gives a capabilities list
  \item
    taking a column (object) gives an access control list
  \item
    each intersection in this matrix defines a set of permissions
  \end{itemize}
\item
  security kernel

  \begin{itemize}
  \tightlist
  \item
    reference validation
  \item
    audit trails via audit logs (user X did Y at time Z)

    \begin{itemize}
    \tightlist
    \item
      these might not necessarily need to be tamper-proof, depends on
      needs
    \end{itemize}
  \item
    needs to be:

    \begin{itemize}
    \tightlist
    \item
      tamper-proof
    \item
      always invoked (not circumventable)
    \item
      verifiable (needs to be minimal / small enough to make this
      possible )
    \end{itemize}
  \end{itemize}
\item
  protection mechanisms

  \begin{itemize}
  \tightlist
  \item
    ticket-oriented (capabilities)

    \begin{itemize}
    \tightlist
    \item
      access token allows entry to an event, as long as ticket is
      authentic
    \end{itemize}
  \item
    id-based

    \begin{itemize}
    \tightlist
    \item
      authorization lists based on ID
    \end{itemize}
  \end{itemize}
\end{itemize}

\hypertarget{jaeger-chapter-1}{%
\subsection{Jaeger Chapter 1}\label{jaeger-chapter-1}}

\begin{itemize}
\tightlist
\item
  general-purpose -\textgreater{} complex
\item
  task-specific -\textgreater{} not so complex
\item
  general purpose OS are hard to secure because of their complexity
\item
  ensuring security depends on securing

  \begin{itemize}
  \tightlist
  \item
    resource mechanisms
  \item
    scheduling mechanisms
  \end{itemize}
\end{itemize}

\hypertarget{secure-os-1}{%
\subsubsection{Secure OS}\label{secure-os-1}}

\begin{itemize}
\tightlist
\item
  enforce security goals despite the threats faced by the system

  \begin{itemize}
  \tightlist
  \item
    implement security mechanisms to do this
  \end{itemize}
\item
  secure OS possible?

  \begin{itemize}
  \tightlist
  \item
    probably not
  \item
    a modern OS by definition can probably never be 100\% secure
  \item
    security as a negative goal
  \end{itemize}
\item
  understanding secure OS requires understanding

  \begin{itemize}
  \tightlist
  \item
    security goals
  \item
    trust model
  \item
    threat model
  \end{itemize}
\end{itemize}

\hypertarget{security-goals}{%
\subsubsection{Security Goals}\label{security-goals}}

\begin{itemize}
\tightlist
\item
  define operations that can be executed by a system while remaining in
  a secure state

  \begin{itemize}
  \tightlist
  \item
    i.e.~prevent unauthorized access
  \end{itemize}
\item
  high level of abstraction
\item
  define a requirement that the system's design can then satisfy
\item
  we want to maintain: secrecy, integrity, availability

  \begin{itemize}
  \tightlist
  \item
    secrecy = limit read access for objects by subjects
  \item
    integrity = limit the write access for objects by subjects
  \item
    availability = limit the resources that a subject may consume
    (i.e.~no DoS)
  \end{itemize}
\item
  subjects

  \begin{itemize}
  \tightlist
  \item
    users, processes, etc.
  \end{itemize}
\item
  objects

  \begin{itemize}
  \tightlist
  \item
    resources of the system that subjects may or may not access in
    various ways
  \item
    e.g.~files, sockets, memory
  \end{itemize}
\item
  security goals can be

  \begin{itemize}
  \tightlist
  \item
    defined by function (e.g.~principle of least privilege)
  \item
    defined by requirements (e.g.~simple-security property)
  \end{itemize}
\end{itemize}

\hypertarget{trust-model}{%
\subsubsection{Trust Model}\label{trust-model}}

\begin{itemize}
\tightlist
\item
  trust model

  \begin{itemize}
  \tightlist
  \item
    defines the set of software and data we trust to help us enforce our
    security goals
  \item
    we depend on this model to correctly enforce our security goals
  \end{itemize}
\item
  trusted computing base

  \begin{itemize}
  \tightlist
  \item
    trust model for an operating system
  \end{itemize}
\item
  TCB should \textbf{ideally} be minimal to the extent that we require

  \begin{itemize}
  \tightlist
  \item
    in practice, this is a wide variety of software
  \end{itemize}
\item
  TCB includes

  \begin{itemize}
  \tightlist
  \item
    all OS code (assuming no boundaries as in a monolithic kernel)
  \item
    other software that defines our security goals
  \item
    other software that enforces our security goals
  \item
    software that bootstraps the above
  \item
    software like Xorg that performs actions on behalf of all other
    processes
  \end{itemize}
\item
  a secure OS developer needs to prove their system has a viable trust
  model

  \begin{enumerate}
  \def\labelenumi{(\arabic{enumi})}
  \tightlist
  \item
    TCB must mediate all sensitive operations
  \item
    verification of the TCB software and data
  \item
    verification of TCB tamper-resistance
  \end{enumerate}
\item
  identifying and verifying TCB is a complex and non-trivial task
\end{itemize}

\hypertarget{threat-model}{%
\subsubsection{Threat Model}\label{threat-model}}

\begin{itemize}
\tightlist
\item
  defines a set of operations that an attacker may use to compromise the
  system
\item
  assume a powerful attacker who

  \begin{itemize}
  \tightlist
  \item
    can inject operations from the network
  \item
    may be in control of non-TCB applications
  \end{itemize}
\item
  if the attacker finds a vulnerability that violates secrecy or
  integrity goals, the system is compromised
\item
  highlights a critical weakness in commercial OSes

  \begin{itemize}
  \tightlist
  \item
    assume that all software running on behalf of a subject is trusted
    by the subject
  \end{itemize}
\item
  our task? protect the TCB from threats

  \begin{itemize}
  \tightlist
  \item
    easier said than done
  \item
    user interacts with a variety of processes
  \item
    users are untrusted
  \item
    TCB interacts with a variety of untrusted processes
  \end{itemize}
\end{itemize}

\hypertarget{jaeger-chapter-2}{%
\subsection{Jaeger Chapter 2}\label{jaeger-chapter-2}}

\hypertarget{protection-system}{%
\subsubsection{Protection System}\label{protection-system}}

\begin{itemize}
\tightlist
\item
  protection system consists of

  \begin{itemize}
  \tightlist
  \item
    protection state
  \item
    protection state operations
  \end{itemize}
\item
  protection state

  \begin{itemize}
  \tightlist
  \item
    what operations can subjects perform on objects
  \end{itemize}
\item
  protection state operations

  \begin{itemize}
  \tightlist
  \item
    what operations can modify the protections state
  \item
    (this is distinct from the operations that the protection state
    describes)
  \end{itemize}
\end{itemize}

\hypertarget{lampsons-access-matrix}{%
\paragraph{Lampson's Access Matrix}\label{lampsons-access-matrix}}

\begin{itemize}
\tightlist
\item
  protection state

  \begin{itemize}
  \tightlist
  \item
    rows = subjects
  \item
    cols = objects
  \item
    select row -\textgreater{} capability list
  \item
    select col -\textgreater{} access control list
  \item
    each entry specified privileges subject -\textgreater{} object
  \end{itemize}
\item
  protection state operations

  \begin{itemize}
  \tightlist
  \item
    determine which processes can modify cells
  \end{itemize}
\end{itemize}

\hypertarget{mandatory-protection-systems}{%
\paragraph{Mandatory Protection
Systems}\label{mandatory-protection-systems}}

\begin{itemize}
\tightlist
\item
  we don't want untrusted processes tampering with the protection
  system's state by adding subjects, objects, operations
\item
  discretionary access control system (DAC)

  \begin{itemize}
  \tightlist
  \item
    an access control system that permits untrusted modification
  \item
    \emph{safety problem}

    \begin{itemize}
    \tightlist
    \item
      how do we ensure that all possible states deriving from initial
      state will not provide unauthorized access
    \end{itemize}
  \end{itemize}
\item
  mandatory protection systems / mandatory access control (MAC)

  \begin{itemize}
  \tightlist
  \item
    protection system can only be modified by trusted administrators via
    trusted software
  \item
    mandatory protection state -\textgreater{} subjects and objects are
    represented by labels

    \begin{itemize}
    \tightlist
    \item
      state describes operations subject labels -\textgreater{} object
      labels
    \end{itemize}
  \item
    labeling state

    \begin{itemize}
    \tightlist
    \item
      state for mapping subjects and objects to labels
    \end{itemize}
  \item
    transition state

    \begin{itemize}
    \tightlist
    \item
      describes legal ways subjects and objects may be relabeled
    \end{itemize}
  \end{itemize}
\item
  set of labels being fixed in MAC doesn't mean that set of
  subjects/objects are fixed

  \begin{itemize}
  \tightlist
  \item
    we can dynamically assign labels to created subjects and objects
    (labeling state)
  \item
    we can dynamically relabel subjects and objects/resources
    (transition state)
  \end{itemize}
\end{itemize}

\hypertarget{reference-monitor}{%
\subsubsection{Reference Monitor}\label{reference-monitor}}

\begin{itemize}
\tightlist
\item
  classical access enforcement mechanism
\item
  takes request as input
\item
  outputs binary response -\textgreater{} is the request authorized or
  not?
\item
  main components?

  \begin{itemize}
  \tightlist
  \item
    interface
  \item
    authorization module
  \item
    policy store
  \end{itemize}
\end{itemize}

\hypertarget{reference-monitor-interface}{%
\paragraph{Reference Monitor
Interface}\label{reference-monitor-interface}}

\begin{itemize}
\tightlist
\item
  defines queries to the reference monitor
\item
  provides an interface for checking security-sensitive operations

  \begin{itemize}
  \tightlist
  \item
    (security-sensitive means it may violate security policy)
  \end{itemize}
\item
  e.g., consider the \passthrough{\lstinline!open!} system call in UNIX
  (reference monitor decides what is allowed / disallowed)
\end{itemize}

\hypertarget{authorization-module}{%
\paragraph{Authorization Module}\label{authorization-module}}

\begin{itemize}
\tightlist
\item
  takes interface inputs, converts to a query for the policy store
\item
  this query is used to check authorization
\item
  authorization module needs to map PID to subject label and object
  references to an object label
\item
  needs to determine the actual operation(s) to authorize
\end{itemize}

\hypertarget{policy-store}{%
\paragraph{Policy Store}\label{policy-store}}

\begin{itemize}
\tightlist
\item
  database that holds protection state, labeling state, transition state
\item
  answers queries from the authorization module
\item
  has specialized queries for each of the three states
\end{itemize}

\hypertarget{secure-operating-system-definition}{%
\subsubsection{Secure Operating System
Definition}\label{secure-operating-system-definition}}

\begin{itemize}
\tightlist
\item
  a secure operating system's access enforcement satisfies the reference
  monitor model
\item
  the reference monitor model defines the necessary and sufficient
  properties of a system that securely enforces MAC
\item
  three guarantees:

  \begin{enumerate}
  \def\labelenumi{(\arabic{enumi})}
  \tightlist
  \item
    complete mediation -\textgreater{} ensure access enforcement for all
    security-sensitive operations
  \item
    tamper proof -\textgreater{} cannot be tampered with from outside
    the TCB (untrusted processes)
  \item
    verifiable -\textgreater{} small enough to be subject to testing,
    analysis
  \end{enumerate}
\end{itemize}

\hypertarget{assessment-criteria}{%
\subsubsection{Assessment Criteria}\label{assessment-criteria}}

\hypertarget{complete-mediation}{%
\paragraph{Complete Mediation}\label{complete-mediation}}

\begin{itemize}
\tightlist
\item
  how does the reference monitor interface ensure that all
  security-sensitive operations are mediated correctly
\item
  does the reference monitor mediate security-sensitive operations on
  all system resources
\item
  how do we verify complete mediation?
\end{itemize}

\hypertarget{tamper-proof}{%
\paragraph{Tamper Proof}\label{tamper-proof}}

\begin{itemize}
\tightlist
\item
  how does the system protect the reference monitor and its protection
  system from modification?
\item
  does the protection system protect TCB programs?
\end{itemize}

\hypertarget{verifiable}{%
\paragraph{Verifiable}\label{verifiable}}

\begin{itemize}
\tightlist
\item
  what is the basis for TCB correctness?
\item
  does the protection system enforce security goals?
\end{itemize}

\hypertarget{multics}{%
\section{Multics}\label{multics}}

\hypertarget{jaeger-chapter-3}{%
\subsection{Jaeger Chapter 3}\label{jaeger-chapter-3}}

\begin{itemize}
\tightlist
\item
  Multics = the first modern OS
\item
  invented many fundamental OS concepts

  \begin{itemize}
  \tightlist
  \item
    segmented virtual memory
  \item
    shared memory for multiprocessors
  \item
    hierarchical filesystems
  \item
    online reconfiguration
  \item
    (many others)
  \end{itemize}
\item
  invented many fundamental \emph{secure OS} concepts

  \begin{itemize}
  \tightlist
  \item
    reference monitor
  \item
    ring protection model
  \item
    protection systems
  \item
    protection domain transactions
  \item
    multilevel security policies
  \item
    (many others)
  \end{itemize}
\end{itemize}

\hypertarget{jaeger-3.1}{%
\subsubsection{Jaeger 3.1}\label{jaeger-3.1}}

\begin{itemize}
\tightlist
\item
  Multics emerged from the CTSS (Compatible Timesharing System) system
\item
  Early timesharing systems could support a few jobs at a time

  \begin{itemize}
  \tightlist
  \item
    vs batch processing could only do one at a time
  \end{itemize}
\item
  Project MAC (Multi-Access Computer) aims to create a general-purpose
  timesharing service to support large number of users simultaneously

  \begin{itemize}
  \tightlist
  \item
    This would require several functions such as multiplexing of devices
    for different processes, scheduling processes, communications
    between processes, and protection from other processes
  \end{itemize}
\item
  IBM wasn't interested in the idea, so GE took over
\item
  Although it was considered a failure (bigger, slower, not reliable),
  it brought important OS and security features that would lead to UNIX
\item
  Multics cost around \$7 million initially (only 80 licenses sold)
\item
  Last department to use Multics was the Canadian Department of Defense
  (LOL we got issues boi)
\end{itemize}

\hypertarget{jaeger-3.2}{%
\subsubsection{Jaeger 3.2}\label{jaeger-3.2}}

\hypertarget{multics-fundamentals}{%
\paragraph{Multics Fundamentals}\label{multics-fundamentals}}

\begin{itemize}
\tightlist
\item
  Processes are executables(they run program code)
\item
  All code, data, I/O devices,etc that processes have access to are
  called segments
\item
  Segments are organized into a hierarchy of directories that may
  contain sub-directories or other segments
\item
  A process's protection domain defines the segments it can access(the
  segments that can be loaded into its descriptor register and the
  operations the process can perform on the segments)
\item
  Segments can be stored in a process's context or secondary storage
\item
  Each process has its own descriptor segment which contains segment
  descriptor words that points to the segments the process has access
  to.
\item
  If the segment is not in the descriptor segment, it must name the
  segment(like a file path). If the process had permission then the
  segment will be added to the descriptor segment.
\end{itemize}

\hypertarget{multics-security-fundamentals}{%
\paragraph{Multics Security
Fundamentals}\label{multics-security-fundamentals}}

\begin{itemize}
\tightlist
\item
  Suppose the login process for the Multics system
\item
  A user logins to an answering service.
\item
  To authenticate the user, the answering service takes the password
  segment from the file system by loading the password Segment
  Descriptor Word(SDW) into its own descriptor segment
\item
  If authorized, the supervisor implements most of MUltics core
  functionalities such as authorization, segmentation, I/O,
  scheduling,etc.
\item
  The protection rings is what protects the supervisor from other
  processes.
\item
  The rings form a hierarchy with ring 0 as the most-privileged.
\item
  The supervisor's segments are assigned to ring 0 and 1.
\item
  Other processes running in higher rings can't modify rings 0 and 1.
  They would need to invoke the supervisor's code that runs in ring 0.
\item
  If the user and password match, the answering service creates a user
  process with the appropriate code and data segments for that user.
\item
  Each live process segment is accessed by the SDW.
\item
  The SDW contains the address of the segment in memory, its length,
  ring brackets, process's permissions, code segments, number of gates
  for the segment.
\item
  The rings brackets in the SDW limits access(rwe) based on the ring the
  process it is currently running in.
\end{itemize}

\hypertarget{multics-protection-system-models}{%
\paragraph{Multics Protection System
Models}\label{multics-protection-system-models}}

\begin{itemize}
\tightlist
\item
  ACL: Each object is associated with its own ACL.

  \begin{itemize}
  \tightlist
  \item
    Each ACL entry specifies the process with a user identity with
    operations that it can perform on this object.
  \item
    Segments can have r,w,e permissions
  \item
    Directories can have r,w,e,s,m,a
  \item
    Segments ACL are stored in its parent's directory

    \begin{itemize}
    \tightlist
    \item
      This means that checking for permission or any modification to
      segment ACL is done through the parent directory
    \end{itemize}
  \item
    If the user with the process has permission for operation on the
    object, then the reference monitor authorizes the creation of SDW
    with those permissions.
  \end{itemize}
\item
  Rings and Brackets:

  \begin{itemize}
  \tightlist
  \item
    Aside from ACL, Multics limits access based on protection rings as
    well
  \item
    Each segment contains a ring bracket that has r,w,e permission of
    processes on that segment

    \begin{itemize}
    \tightlist
    \item
      A segment's bracket defines the ranges of ring that can have
      certain permission(rwe) to the segment
    \end{itemize}
  \item
    Suppose a process from ring r wants to access a segment with an
    access brackets of (r1,r2). We need to follow these rules:

    \begin{itemize}
    \tightlist
    \item
      If r\textless r1, then the process can read and write to the
      segment
    \item
      If r1 \textless= r \textless= r2, then the process can read the
      segment only
    \item
      If r2 \textless{} r, then the process has no access to the segment
    \end{itemize}
  \item
    The above rules ensure that lower rings are more privileged and has
    more access to segments than higher rings
  \item
    The call bracket is to control the calls to the code segments.
  \item
    Suppose a process from ring r wants to invoke a code segment with an
    access bracket of (r1,r2) and a call bracket of (r2,r3): We need to
    follow these rules:

    \begin{itemize}
    \tightlist
    \item
      If r\textless r1, then the process can execute the code segment,
      but there is a ring transition from r to a lower privileged ring
      r1 \textless= r' \textless= r2 specified by the segment
    \item
      If r1 \textless= r \textless= r2, then the process invokes the
      code segment in its current ring r
    \item
      If r2 \textless= r \textless= r3, then the process can execute the
      code segment, there is a ring transition from r to the higher
      privileged ring r' if authorized by the gates in the code
      segment's SDW
    \item
      If r3 \textless{} r, then the process cannot invoke the code
      segment
    \end{itemize}
  \item
    Call brackets does not only define execute privileges but for
    defining transition rules as well. It is the only way to transition
    state in Multics.
  \end{itemize}
\item
  Multilevel Security

  \begin{itemize}
  \tightlist
  \item
    Each directory stores a mapping from each segment to a secrecy
    level.
  \item
    Multics also stores an association between each process and its
    secrecy level.
  \item
    A request is authorized if one of 3 conditions are met.

    \begin{itemize}
    \tightlist
    \item
      Write: The process requests write access only and the level of the
      segment/directory is greater than or equal to the level of the
      process.
    \item
      Read: The process requests read access only and the level of the
      segment/directory is less than or equal to the level of the
      process.
    \item
      Read/Write: The process requests read and write access and the
      level of the segment/directory is the same as the process or the
      process is designated as trusted
    \end{itemize}
  \end{itemize}
\end{itemize}

\hypertarget{multics-protection-system}{%
\paragraph{Multics Protection System}\label{multics-protection-system}}

\begin{itemize}
\tightlist
\item
  Multic's protection consists of these 3 policies:

  \begin{itemize}
  \tightlist
  \item
    Requested operation is READ:

    \begin{itemize}
    \tightlist
    \item
      ACL checks if user has read access
    \item
      MLS policy checks to verify that the object's secrecy level is
      dominated by or equal to the process
    \item
      The access bracket is checked to ensure the process has access to
      the object's segment
    \end{itemize}
  \item
    Requested operation is WRITE:

    \begin{itemize}
    \tightlist
    \item
      ACL checks if user has write access
    \item
      MLS policy checks to verify that the object's secrecy level
      dominates or equal to the process
    \item
      The access bracket must allow the current ring write access
    \end{itemize}
  \item
    Requested operation is EXECUTE:

    \begin{itemize}
    \tightlist
    \item
      Similar to write operation
    \item
      The process must have execute permission in the segment's ACL
    \item
      MLS policy must allow for reading the segment
    \item
      Call bracket is used instead of access bracket, and call bracket
      must allow execution
    \item
      The request may result in protection domain transition

      \begin{itemize}
      \tightlist
      \item
        Transition from process's current ring r to the ring specified
        by the segment in the call bracket r'
      \item
        When a process invokes a code segment with a call bracket with r
        \textless{} r1:

        \begin{itemize}
        \tightlist
        \item
          The process must transition to r'(a lower privileged ring)
        \end{itemize}
      \item
        When a process invokes a code segment with a call bracket where
        r2 \textless= r \textless= r3:

        \begin{itemize}
        \tightlist
        \item
          The process transitions to r' by using one of the gates in the
          code segment as entry point
        \end{itemize}
      \end{itemize}
    \end{itemize}
  \item
    From Chapter 2 we have seen that a secure protection system requires
    a protection state, a labeling state, and a transition state.
    Multics built their protection state based on the 3 models.
  \end{itemize}
\end{itemize}

\hypertarget{multics-reference-monitor}{%
\paragraph{Multics Reference Monitor}\label{multics-reference-monitor}}

\begin{itemize}
\tightlist
\item
  Multic's reference monitor was implemented by the supervisor.
\item
  Each Multics instruction either accesses a segment via a directory or
  via a SDW, so authorization is performed on each instruction
\item
  The supervisor also performs protection domain transitions as
  mentioned above
\item
  A transition that requires to go through a gate segment needs to
  verify the following:

  \begin{itemize}
  \tightlist
  \item
    the number of arguments expected
  \item
    the data type on each argument
  \item
    access requirement for each argument(read, read/write)
  \end{itemize}
\item
  The gate segment is also known as the gatekeeper
\item
  When we return from the more privileged ring to a lower privileged
  ring, we need to ensure that no information is leaked.

  \begin{itemize}
  \tightlist
  \item
    The supervisor copies arguments from its segment to another
    segment(accesible to the called procesure).

    \begin{itemize}
    \tightlist
    \item
      Copying is necessary because we don't want unauthorized access
      from the calling procedure
    \item
      The caller must also be careful not to copy unauthorized
      information(private keys), since the less-privileged code may be
      able to use to impersonate the higher-privileged code
    \end{itemize}
  \item
    Multics allows the caller to provide a gate for return(return gate).

    \begin{itemize}
    \tightlist
    \item
      Multiple calls can result in a stack of return gates, so SDW is
      not suitable for return gates
    \item
      The supervisor must maintain this stack of return gates for each
      process.
    \end{itemize}
  \end{itemize}
\item
  The fundamentals of the reference monitor is implemented in ring 0

  \begin{itemize}
  \tightlist
  \item
    Other utility such as file system search utility are in ring 1.
    determination of a directory or segment from a name is performed
    there, but authorization of whether this access is permitted is done
    in ring 0
  \end{itemize}
\end{itemize}

\hypertarget{jaeger-3.3}{%
\subsubsection{Jaeger 3.3}\label{jaeger-3.3}}

\hypertarget{complete-mediation-1}{%
\paragraph{Complete Mediation}\label{complete-mediation-1}}

\begin{itemize}
\tightlist
\item
  How does the reference monitor interface ensure that all
  security-sensitive operations are mediated correctly?

  \begin{itemize}
  \tightlist
  \item
    Multics provides complete mediation at the segment level.
  \end{itemize}
\item
  Does the reference monitor interface mediate security-sensitive
  operations on all system resources?

  \begin{itemize}
  \tightlist
  \item
    Multics mediates each segment access at the instruction
    level,Multics mediates memory access completely. Multics also
    mediates ring transitions, in both directions. Thus, the reference
    monitor provides mediation at memory and ring levels.
  \end{itemize}
\item
  How do we verify that the reference monitor interface provides
  complete mediation?

  \begin{itemize}
  \tightlist
  \item
    To verify complete mediation, we need to verify that ring
    transitions and segment accesses are mediated correctly. These
    operations are well-defined, so it is straightforward to determine
    that mediation occurs at these operations.
  \end{itemize}
\end{itemize}

\hypertarget{tamper-proof-1}{%
\paragraph{Tamper-proof}\label{tamper-proof-1}}

\begin{itemize}
\tightlist
\item
  How does the system protect the reference monitor, including its
  protection system from modification?

  \begin{itemize}
  \tightlist
  \item
    Multic's reference monitor is implemented by ring 0 procedures. Ring
    0 procedures are protected by a combination of protection ring
    isolations and system-defined ring bracket policy. The ring bracket
    policy prevent processes outside of ring 0 from reading or writing
    reference monitor code or state directly.
  \end{itemize}
\item
  Does the protection system protect all the trusted computing base
  programs?

  \begin{itemize}
  \tightlist
  \item
    Multics TCB consists of the supervisor(ring 0) and from ring 1 to
    ring 3. Ring 4 and above are standard user processing. Rings 0 to 3
    can be considered part of the TCB.
  \end{itemize}
\end{itemize}

\hypertarget{verifiable-1}{%
\paragraph{Verifiable}\label{verifiable-1}}

\begin{itemize}
\tightlist
\item
  What is basis for the correctness of the system's trusted computing
  base?

  \begin{itemize}
  \tightlist
  \item
    The implementation of the Multics TCB is too large to be formally
    verified. This goal was not achieved even though they did try to aim
    to minimize the implementation as much as possible
  \end{itemize}
\item
  Does the protection system enforce the system's security goals?

  \begin{itemize}
  \tightlist
  \item
    Protection state: MLS secrecy protection is enforced as long as the
    TCB is not compromised
  \item
    Labeling state: Verifying the correct labeling of segments and
    processes is challenging, since most of the labeling is done
    manually. The Multics policy does not explicitly state how new
    processes and segments are labeled
  \item
    Transition state: Permits code from a less-privileged ring to
    transfer control to code in a more-privileged ring through either
    gates or return gates based on the call bracket rules. The security
    of these transitions depends on the correctness of the gates
  \end{itemize}
\end{itemize}

\hypertarget{virtual-memory-in-multics-video}{%
\subsection{Virtual Memory in Multics
(Video)}\label{virtual-memory-in-multics-video}}

\hypertarget{generating-address}{%
\paragraph{Generating Address}\label{generating-address}}

\begin{itemize}
\tightlist
\item
  36 bits in total

  \begin{itemize}
  \tightlist
  \item
    18 bit segment number
  \item
    18 bit word number
  \end{itemize}
\item
  i.e.~\(2^{18}\) segments and within each segment \(2^{18}\) words
\end{itemize}

\hypertarget{instruction-format}{%
\paragraph{Instruction Format}\label{instruction-format}}

\begin{itemize}
\tightlist
\item
  segment tag

  \begin{itemize}
  \tightlist
  \item
    has segment number and word number
  \end{itemize}
\item
  address
\item
  operation code
\item
  external flag
\item
  addressing mode (2 bits)

  \begin{itemize}
  \tightlist
  \item
    corresponds to one of four pointers

    \begin{enumerate}
    \def\labelenumi{(\arabic{enumi})}
    \tightlist
    \item
      argument pointer
    \item
      base pointer (bottom of stack frame)
    \item
      linkage pointer
    \item
      stack pointer (top of stack {[}frame{]})
    \end{enumerate}
  \end{itemize}
\end{itemize}

\hypertarget{segment-number}{%
\paragraph{Segment Number}\label{segment-number}}

\begin{itemize}
\tightlist
\item
  can only be changed by ring 0 (supervisor mode) program
\end{itemize}

\hypertarget{word-number}{%
\paragraph{Word Number}\label{word-number}}

\begin{itemize}
\tightlist
\item
  can be changed by user mode programs
\end{itemize}

\hypertarget{switching-processes}{%
\paragraph{Switching Processes}\label{switching-processes}}

\begin{itemize}
\tightlist
\item
  all the kernel does is substitute a new descriptor base register (with
  a different segment number)
\end{itemize}

\hypertarget{apple-ii-and-stuff-1982}{%
\paragraph{Apple II and Stuff (1982)}\label{apple-ii-and-stuff-1982}}

\begin{itemize}
\tightlist
\item
  introduced copy protection on memory / disks
\item
  no virtual memory (they didn't need it, hobbyists didn't need to care
  about security)
\end{itemize}

\hypertarget{protection-in-an-information-processing-utility-graham-1968}{%
\subsection{Protection in an information processing utility (Graham
1968)}\label{protection-in-an-information-processing-utility-graham-1968}}

\hypertarget{challenges-of-protecting-an-ipu}{%
\paragraph{Challenges of protecting an
IPU}\label{challenges-of-protecting-an-ipu}}

\begin{itemize}
\tightlist
\item
  lots of users
\item
  many users using the system simultaneously
\item
  more than one CPU, running multiple programs at a time
\item
  sharing and not sharing

  \begin{itemize}
  \tightlist
  \item
    system could be used for applications that have sensitive data
  \item
    system could also be used by applications that do want to share
    their memory with others (maybe on parts of it)
  \end{itemize}
\end{itemize}

\hypertarget{why-do-we-need-protection}{%
\paragraph{Why do we need protection?}\label{why-do-we-need-protection}}

\begin{itemize}
\tightlist
\item
  protection is not strictly necessary for single-user applications, but
  still desirable

  \begin{itemize}
  \tightlist
  \item
    aid debugging
  \item
    prevent application errors from propagating (good even in the benign
    case)
  \item
    (localizes the source of the original error)
  \end{itemize}
\item
  more than one user makes things much more interesting

  \begin{itemize}
  \tightlist
  \item
    even simplest multi-user systems share the supervisor program
    (i.e.~reference monitor state) between all users
  \item
    we need to protect this from being tampered with
  \item
    user information stored on multi-user system must be protected for
    privacy reasons
  \end{itemize}
\end{itemize}

\hypertarget{defining-satisfactory-and-unsatisfactory-protection-mechanisms}{%
\subsubsection{Defining Satisfactory and Unsatisfactory Protection
Mechanisms}\label{defining-satisfactory-and-unsatisfactory-protection-mechanisms}}

\hypertarget{protection-mechanisms-before-multics-unsatisfactory}{%
\paragraph{Protection Mechanisms Before Multics
(Unsatisfactory)}\label{protection-mechanisms-before-multics-unsatisfactory}}

\begin{itemize}
\tightlist
\item
  mode switch for supervisor instructions (paper calls them master and
  slave)
\item
  memory bounds register (descriptor register)
\item
  what is included in privileged instructions?

  \begin{itemize}
  \tightlist
  \item
    I/O instructions
  \item
    changing mode switch
  \item
    changing contents of memory bounds register
  \end{itemize}
\item
  mode switch can protect information on storage media that is not
  actively being looked at

  \begin{itemize}
  \tightlist
  \item
    but it cannot protect data in active memory\ldots{} we need the
    memory bounds register for that
  \end{itemize}
\item
  what was wrong with the original solution?

  \begin{itemize}
  \tightlist
  \item
    all or nothing
  \item
    either have all privileges, or have none
  \item
    \textbf{unsatisfactory} for an IPU
  \end{itemize}
\end{itemize}

\hypertarget{satisfactory-protection-mechanism-properties}{%
\paragraph{Satisfactory Protection Mechanism
Properties}\label{satisfactory-protection-mechanism-properties}}

\begin{itemize}
\tightlist
\item
  isolation

  \begin{itemize}
  \tightlist
  \item
    should be possible to completely isolate one process from another
  \end{itemize}
\item
  sharing

  \begin{itemize}
  \tightlist
  \item
    should be easy and convenient to select which parts of a process
    should be shared with another process
  \end{itemize}
\item
  layering

  \begin{itemize}
  \tightlist
  \item
    single process layers of protection should be available to system
    and user
  \item
    ``need to know'' principle should be easily applicable to a
    reasonable degree
  \end{itemize}
\item
  calling procedures across layers

  \begin{itemize}
  \tightlist
  \item
    should be do-able without any special programming
  \end{itemize}
\end{itemize}

\hypertarget{the-abstract-model}{%
\subsubsection{The Abstract Model}\label{the-abstract-model}}

\hypertarget{segment-descriptor-isolation-sharing}{%
\paragraph{Segment Descriptor (Isolation,
Sharing)}\label{segment-descriptor-isolation-sharing}}

\begin{itemize}
\tightlist
\item
  pages are invisible to the user (managed by hardware)
\item
  segments contain words of arbitrary length stored in pages
\item
  addressing is done by \((S,W)\) where \(S\) is segment number and
  \(W\) is word number
\item
  descriptor needs to have

  \begin{itemize}
  \tightlist
  \item
    beginning of segment
  \item
    length
  \item
    access indicator
  \item
    (ring number)
  \end{itemize}
\item
  every processor has exactly one segment descriptor
\end{itemize}

\hypertarget{location-counter}{%
\paragraph{Location Counter}\label{location-counter}}

\begin{itemize}
\tightlist
\item
  what does this do? unclear
\item
  needs to have

  \begin{itemize}
  \tightlist
  \item
    (ring number)
  \item
    procedure segmnt number
  \item
    word number
  \end{itemize}
\end{itemize}

\hypertarget{protection-rings-layering}{%
\paragraph{Protection Rings
(Layering)}\label{protection-rings-layering}}

\begin{itemize}
\tightlist
\item
  up to \(m\) rings
\item
  ring 0 is most privileged, ring \(m\) is least privileged
\item
  every segment is assigned to one and only one ring
\item
  a process running in ring \(i\) has no access to any segment in ring
  \(j < i\)
\end{itemize}

\printbibliography

\end{document}
